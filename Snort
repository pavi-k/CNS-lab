WHAT you need to do:

Install snort version-v2.9
replace the rules folder
make changes in snort.conf file in C->snort->etc->snort.conf
save changes
open cmd
snort -> bin change directory
This command opens an interface b/w snort and the machine.
Run Snort -W 

Starts IDS mode
Run snort -i 3 -c C:\Snort\etc\snort.conf -A console

Opens log files in ASCII while Running IDS mode 

snort -A console -i3 -c c:\Snort\etc\snort.conf -l c:\Snort\log -K ascii


ALGORITHM:

Download SNORT from snort.org. Install snort
Download Rules.
Install WinPCAP.
Extract the Rules file. You will need WinRAR for the .gz file.
Copy all files from the “rules” folder of the extracted folder. Now paste the
rules into the “C:\Snort\rules” folder.
Copy “snort.conf” file from the “etc” folder of the extracted folder. You must paste it into the “C:\Snort\etc” folder. Overwrite any existing file.
Add the path variable in the Windows environment variable by selecting new classpath.
Create a path variable and point it at snort.exe variable name path and variable value c:\snort\bin.
Click the OK button and then close all dialog boxes. Open command prompt and navigate to folder “C:\Snort\bin” folder.
Type the following commands:
Snort –W
This is to find the interface.

Do the following changes in snort.conf file:

To specify the network address that you want to protect in snort.conf file,look for the following line.
var HOME_NET 192.168.1.0/24 (Add IP)
Change the RULE_PATH variable to the path of rules folder. var RULE_PATH c:\snort\rules
Change the path of all library files with the name and path on your system.
And you must change the path of snort_dynamicpreprocessorvariable. C:\Snort\lib\snort_dynamiccpreprocessor
You need to do this to all library files in the “C:\Snort\lib” folder. The
old path might be: “/usr/local/lib/...”. you will need to replace that path with your system path. Using C:\Snort\lib
Change the path of the “dynamicengine” variable value in the “snort.conf” file.
dynamicengine C:\Snort\lib\snort_dynamicengine\sf_engine.dll
Add the paths for “include classification.config” and “include reference.config” files.


include c:\snort\etc\classification.config include c:\snort\etc\reference.config
Remove the comment (#) on the line to allow ICMP rules, if it is commented with a #.
include $RULE_PATH/icmp.rules
You can also remove the comment of ICMP-info rules comment, if it is commented.
include $RULE_PATH/icmp-info.rules
To add log files to store alerts generated by snort, search for the “output log” test in snort.conf and add the following line:
output alert_fast: snort-alerts.ids
Find $WHITE_LIST_PATH/white_list.rules and change it to white.list and similarly black_list.rules to black.list
Create white.list and black.list file in C:\Snort\rules.
Add the ip address that needs to be blacklisted in black.list file.


Comment out (#) following lines: #preprocessor normalize_ip4
#preprocessor normalize_tcp: ips ecn stream
#preprocessor normalize_icmp4 #preprocessor normalize_ip6 #preprocessor normalize_icmp6
Save the “snort.conf” file.

To start snort in IDS mode, run the following command:

snort -i 3 -c C:\Snort\etc\snort.conf -A console
To generate Log files in ASCII mode, you can use following command while running snort in IDS mode:

snort -A console -i3 -c c:\Snort\etc\snort.conf -l c:\Snort\log -K ascii

